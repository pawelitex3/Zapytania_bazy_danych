ZAJĘCIA 6.11.2018 BAZY DANYCH - ĆWICZENIA 5

Zapytania do bazy danych USOS

1. Wyświetlić imię, nazwisko studenta oraz grupę zajęć do której chodzą na zajęcia Bazy danych.

SELECT s.imie, s.nazwisko, g.numer
FROM studenci s inner join zaliczenia z on (s.id_studenta=z.id_studenta) inner join grupy g on (z.id_grupy=g.id_grupy) inner join przedmioty p on (g.id_przedmiotu=p.id_przedmiotu)
WHERE p.nazwa LIKE 'Bazy danych';

2. Informacje o tym kto studiuje razem z Janem Kowalskim i w której grupie.

Z PODZAPYTANIEM

SELECT s.imie, s.nazwisko, g.numer, g.id_grupy
FROM studenci s JOIN zaliczenia z ON (s.id_studenta=z.id_studenta) 
                JOIN grupy g ON (z.id_grupy=g.id_grupy)
WHERE g.id_grupy IN (
                     SELECT g.id_grupy
                     FROM studenci s JOIN zaliczenia z ON (s.id_studenta=z.id_studenta)
                                     JOIN grupy g ON (z.id_grupy=g.id_grupy)
                     WHERE s.imie = 'Jan' AND s.nazwisko = 'Kowalski'
                     )
      AND NOT s.imie = 'Jan'
      AND NOT s.nazwisko = 'Kowalski';
      

BEZ PODZAPYTANIA

SELECT s.imie, s.nazwisko, g.numer, g.id_grupy
FROM studenci s JOIN zaliczenia z ON (s.id_studenta=z.id_studenta) 
                JOIN grupy g ON (z.id_grupy=g.id_grupy),
     studenci jk JOIN zaliczenia zal ON (jk.id_studenta=zal.id_studenta) 
                 JOIN grupy gr ON (zal.id_grupy=gr.id_grupy)
WHERE jk.imie = 'Jan'
      AND jk.nazwisko = 'Kowalski'
      AND g.id_grupy = gr.id_grupy
      AND not s.imie = 'Jan'
      AND not s.nazwisko = 'Kowalski';
      
            
3. Wyświetlić średnie ocen studentów

SELECT s.imie, s.nazwisko, ROUND(AVG(z.ocena), 2) AS "Średnia ocen"
FROM studenci s JOIN zaliczenia z ON (s.id_studenta=z.id_studenta)
WHERE z.ocena NOT IN (0, 1)
GROUP BY s.id_studenta, s.imie, s.nazwisko
ORDER BY s.id_studenta;
